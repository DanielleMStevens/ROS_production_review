nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "Elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "Csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "Flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 75, hjust=0.95, vjust=0.2, size =12))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "Elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "Csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "Flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "Elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "Csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "Flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12), axis.text.y = element_text(size=12))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "Elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "Csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "Flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12),
axis.text.y = element_text(size=12),
axis.title = element_text(size = 14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "Elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "Csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "Flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "Elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "Csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "Flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
source("./Theme_ggplot.R")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_minimal() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial"),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank())
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_minimal() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial"),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", size = 0.8))
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
my_ggplot_theme +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_bw() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial"),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", size = 0.5))
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
my_ggplot_theme +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust=0.95, vjust=0.2, size =12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_bw() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial"),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank(),
axis.line = element_line(colour="black"))
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_bw() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial", hjust = 0.95, vjust = 0.2),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank(),
axis.line = element_line(colour="black"),
element_rect(colour = NA))
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_bw() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial", hjust = 0.95, vjust = 0.2),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank(),
axis.line = element_line(colour="black"),
panel.border = element_rect(colour = NA))
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_bw() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial", hjust = 0.95, vjust = 0.2),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank(),
panel.border = element_rect(color = "black", size = 0.5))
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
my_ggplot_theme +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2, size = 13),
axis.text.y = element_text(size = 13),
axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
title = element_text(size = 16, face = "bold"))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
my_ggplot_theme +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
ggtitle(name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2, size = 13),
axis.text.y = element_text(size = 13),
axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
title = element_text(size = 15, face = "bold"))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
my_ggplot_theme +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
labs(title =name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2, size = 13),
axis.text.y = element_text(size = 13),
axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
title = element_text(size = 15, face = "bold"))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
plot_points_Percent_Ident_of_MAMPs <- function(MAMP_of_interest, name_of_MAMP){
new_plot <- ggplot(MAMP_of_interest, aes(x = Genera, y = Percent_Identity, colour = Genera)) +
my_ggplot_theme +
geom_boxplot(color = "black", outlier.alpha = 0, alpha = 0.7) +
geom_point(aes(x = Genera, fill = Genera), shape = 21, size = 1,  position = position_jitterdodge(jitter.width = 1.5,
jitter.height = 1, dodge.width = 1)) +
#geom_beeswarm(size=2,priority='random')+
#geom_jitter(width = 0.25, alpha = 0.6) +
scale_color_manual("Genera", values = Genera_colors) +
scale_fill_manual("Genera", values = Genera_colors) +
xlab("\n Genera") +
ylab("") +
scale_y_continuous(limits = c(40,100),
breaks = c(40,50,60,70,80,90,100)) +
labs(title =name_of_MAMP) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2, size = 13),
axis.text.y = element_text(size = 13),
axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 15),
title = element_text(size = 14, face = "bold"))
return(new_plot)
}
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
my_ggplot_theme <- theme_bw() +
theme(axis.title.x = element_text(size = 12, color = "black", family = "Arial"),
axis.title.y = element_text(size = 12, color = "black", family = "Arial"),
axis.text.x = element_text(size = 11,  color = "black", family = "Arial", hjust = 0.95, vjust = 0.2),
axis.text.y = element_text(size = 11, color = "black", family = "Arial"),
panel.grid = element_blank())
ggarrange(plot_points_Percent_Ident_of_MAMPs(only_Elf18_MAMP, "elf18") + ylab("Percent Identity \n"),
plot_points_Percent_Ident_of_MAMPs(only_Csp22_MAMP, "csp22"),
plot_points_Percent_Ident_of_MAMPs(only_Flg22_MAMP, "flg22"),
nrow = 1, ncol = 3, common.legend = TRUE, legend = "none")
# plot tree
just_MLSA_rec <- ggtree(mytree_mid, layout = "circular", ladderize = T, size = 0.5, linetype = 1) %<+% datasettable +
geom_tippoint(aes(color = Genera), size = 1.5) +
scale_color_manual("Genera", values = Genera_colors)
# need to make data table to map bootstrap values onto tree
d <- just_MLSA_rec$data
d <- d[!d$isTip,]
d$label <- as.numeric(d$label)
d <- d[d$label > 70,]
just_MLSA_rec <- just_MLSA_rec +
geom_nodepoint(data = d, aes(label = label), size = 0.65, alpha = 0.6)
just_MLSA_rec <- just_MLSA_rec + ggnewscale::new_scale_fill()
gheatmap(just_MLSA_rec, MAMP_reshaped, colnames = TRUE, colnames_offset_y = 1, colnames_position = "top",
colnames_angle = 90, font.size = 2, width = 0.3)
# make sure to set path to the same place where the figure
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# make sure to set path to the same place where the figure
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(Biostrings)
library(seqinr)
library(ggmsa)
library(reshape2)
library(cowplot)
library(ggpubr)
#library(postscriptFonts)
library(ggseqlogo)
library(extrafont)
loadfonts(device = "pdf", quiet = FALSE)
source("./Theme_ggplot.R")
# turning AAmultiplesequence alignment into dataframe
aa2df <- function(dss){
return(data.frame(names = rownames(dss), seq = as.character(dss), stringsAsFactors = FALSE))
}
# turning AAsequences (fasta) into dataframe
dss2df <- function(dss){
return(data.frame(width = width(dss), names = names(dss), seq = as.character(dss), stringsAsFactors = FALSE))
}
calculate_sim_score <- function(full_sequence_in, blast_hit_in){
seq_global <- Biostrings::pairwiseAlignment(reference_AtRBOHD, full_sequence_in, type = 'global', substitutionMatrix = "BLOSUM62")
seq_local <- Biostrings::pairwiseAlignment(AtRBODH_Cterm_highlight_region, blast_hit_in, type = 'global', substitutionMatrix = "BLOSUM62")
my_list <- data.frame("Full Length RBOHD" = pid(seq_global, "PID1"), "RBOHD C-terminus" = pid(seq_local, "PID1"))
return(my_list)
}
## alternate method
hold_file <- Biostrings::readAAStringSet(filepath = "./NADPH_oxidase_homologs.fasta", format = "fasta") #NADPH_oxidase_homologs.fasta
holdSeq2 <- dss2df(hold_file)
reference_AtRBOHD <- holdSeq2[grepl("AtRBOHD",holdSeq2$names),3]
AtRBODH_Cterm_highlight_region <- substr(reference_AtRBOHD,680,1000)
holdBlast_hits <- Biostrings::readAAStringSet(filepath = "./C-term-hits.fasta", format = 'fasta') #C-term-hits.fasta
holdBlast_hits <- dss2df(holdBlast_hits)
rownames(holdBlast_hits) <- NULL
hold_local_global_Scores <- data.frame("Full Length" = as.numeric(), "C-terminus" = as.numeric())
for (i in 1:nrow(holdSeq2)){
find_blast_hit_seq <- holdBlast_hits[grepl(holdSeq2[i,2], holdBlast_hits$names, fixed = TRUE),]
if (nrow(find_blast_hit_seq) == 0){
#two in original list didn't meet high enough standards after blast search, so we skip their name
next
}
if (nrow(find_blast_hit_seq) == 1){
hold_local_global_Scores <- rbind(hold_local_global_Scores, calculate_sim_score(holdSeq2[i,3], find_blast_hit_seq[,3]))
}
if (nrow(find_blast_hit_seq) > 1){
for (j in 1:nrow(find_blast_hit_seq)){
hold_local_global_Scores <- rbind(hold_local_global_Scores, calculate_sim_score(holdSeq2[i,3], find_blast_hit_seq[j,3]))
}
}
}
# alter data to plot
colnames(hold_local_global_Scores) <- c("Full Length","C-terminus")
melt_hold_local_global_Scores <- melt(hold_local_global_Scores)
# alter data to plot
colnames(hold_local_global_Scores) <- c("Full Length","C-terminus")
melt_hold_local_global_Scores <- reshape2::melt(hold_local_global_Scores)
# plot data
ggplot(melt_hold_local_global_Scores, aes(x = variable, y = value)) +
geom_boxplot(fill = "grey60", alpha = 0.6, outlier.alpha = 0) +
geom_jitter(fill = "black", alpha = 0.4, width = 0.2) +
my_ggplot_theme +
ylab("Percent AA Similarity") +
# I used 99 instead of 100 to remove the one score that comparing the reference to itself
ylim(0,99) +
xlab("")
AtRBODH_Hterm_highlight_region <- substr(reference_AtRBOHD,1,376)
length(reference_AtRBOHD)
nchar(reference_AtRBOHD)
substr(reference_AtRBOHD,680,1000)
substr(reference_AtRBOHD,680,nchar(reference_AtRBOHD))
substr(reference_AtRBOHD,1,376)
reticulate::repl_python()
